"use strict";!function(){function t(t,e,n,r,o){n.defaults.transformResponse.push(function(t){return void 0!==notices[t.status_id]&&notie.alert(1,notices[t.status_id],.3),angular.isDefined(t.data)&&"success"===t.status?t=t.data:t}),n.interceptors.push("timestampMarker"),n.interceptors.push("tokenInjector"),n.defaults.transformRequest=function(t){var e=[];for(var n in t)e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")},e.html5Mode(!0),n.defaults.headers.post={"Content-Type":"application/x-www-form-urlencoded"},n.defaults.headers.put={"Content-Type":"application/x-www-form-urlencoded"},n.defaults.headers["delete"]={"Content-Type":"application/x-www-form-urlencoded"},r.otherwise("/"),o.extendConfig({spinnerTpl:'<i class="btn-spinner"></i>',disableBtn:!0,btnLoadingClass:"is-loading",addClassToCurrentBtnOnly:!1,disableCurrentBtnOnly:!1}),t.state("index",{url:"/",views:{main:{templateUrl:"index/index_tpl.html",controller:"IndexCtrl",controllerAs:"vm"}}}).state("recommend",{url:"/books/recommend",views:{main:{controller:"RecommendMoreCtrl",templateUrl:"recommend_more/recommend_more_tpl.html",controllerAs:"vm"}}}).state("booklists",{url:"/booklists",views:{main:{controller:"BooklistsCtrl",templateUrl:"booklists/booklists_tpl.html",controllerAs:"vm"}}}).state("popular",{url:"/booklists/popular",views:{main:{controller:"PopularMoreCtrl",templateUrl:"popular_more/popular_more_tpl.html",controllerAs:"vm"}}}).state("book",{url:"/book/{isbn}",views:{main:{controller:"BookCtrl",templateUrl:"book/book_tpl.html",controllerAs:"vm"},nav:{template:"<span></span>"}}}).state("bookDetail",{url:"/book/{isbn}/detail",views:{main:{controller:"BookInfoCtrl",templateUrl:"book_info/book_info_tpl.html",controllerAs:"vm"},nav:{template:"<span></span>"}}}).state("booklist",{url:"/booklist/{id}",views:{main:{controller:"BookListCtrl",templateUrl:"booklist/booklist_tpl.html",controllerAs:"vm"},nav:{template:"<span></span>"}}}).state("booklistComments",{url:"/booklist/{id}/comments",views:{main:{controller:"BooklistCommentsCtrl",templateUrl:"booklist_comments/booklist_comments_tpl.html",controllerAs:"vm"},nav:{template:"<span></span>"}}}).state("tagBooklists",{url:"/booklists/{tag}",views:{main:{controller:"TagBooklistsCtrl",templateUrl:"tag-booklists/tag-booklists_tpl.html",controllerAs:"vm"}}}).state("commentsBook",{url:"/comments/{isbn}",views:{main:{controller:"CommentsCtrl",templateUrl:"comments/comments_tpl.html",controllerAs:"vm"}}}).state("tags",{url:"/tags",views:{main:{controller:"TagsCtrl",templateUrl:"tags/tags_tpl.html",controllerAs:"vm"}}}).state("me",{url:"/me",views:{main:{controller:"MeCtrl",templateUrl:"me/me_tpl.html",controllerAs:"vm"}}}).state("cart",{url:"/cart",views:{main:{controller:"CartCtrl",templateUrl:"cart/cart_tpl.html",controllerAs:"vm"}}}).state("orders",{url:"/orders/{status}/show",views:{main:{controller:"OrdersCtrl",templateUrl:"orders/orders_tpl.html",controllerAs:"vm"}}}).state("orderDetail",{url:"/order/{id}/detail",views:{main:{controller:"OrderDetailCtrl",templateUrl:"order_detail/order_detail_tpl.html",controllerAs:"vm"},nav:{template:"<span></span>"}}}).state("orderComments",{url:"/order/{id}/comments",views:{main:{controller:"OrderCommentsCtrl",templateUrl:"order_comments/order_comments_tpl.html",controllerAs:"vm"},nav:{template:"<span></span>"}}}).state("ordersCommented",{url:"/orders/commented",views:{main:{controller:"OrdersCommentedCtrl",templateUrl:"orders_commented/orders_commented_tpl.html",controllerAs:"vm"}}}).state("comments",{url:"/comments",views:{main:{controller:"UserCommentsCtrl",templateUrl:"user_comments/user_comments_tpl.html",controllerAs:"vm"}}}).state("booklistsCollect",{url:"/collect/booklists",views:{main:{controller:"CollectBookListsCtrl",templateUrl:"collect_booklists/collect_booklists_tpl.html",controllerAs:"vm"}}}).state("booksCollect",{url:"/collect/books",views:{main:{controller:"CollectBooksCtrl",templateUrl:"collect_books/collect_books_tpl.html",controllerAs:"vm"}}}).state("point",{url:"/point",views:{main:{controller:"PointCtrl",templateUrl:"point/point_tpl.html",controllerAs:"vm"}}}).state("notices",{url:"/notices",views:{main:{controller:"NoticesCtrl",templateUrl:"notices/notices_tpl.html",controllerAs:"vm"}}}).state("settings",{url:"/settings",views:{main:{controller:"SettingsCtrl",templateUrl:"settings/settings_tpl.html",controllerAs:"vm"}}}).state("address",{url:"/setting/address",views:{main:{controller:"AddressCtrl",templateUrl:"setting_address/setting_address_tpl.html",controllerAs:"vm"}}}).state("AddressAdd",{url:"/setting/address/add",views:{main:{controller:"AddressAddCtrl",templateUrl:"setting_address_add/setting_address_add_tpl.html",controllerAs:"vm"}}}).state("cart2order",{url:"/cart2order",views:{main:{controller:"Cart2OrderCtrl",templateUrl:"cart2order/cart2order_tpl.html",controllerAs:"vm"},nav:{template:"<span></span>"}}}).state("suggest",{url:"/suggest",views:{main:{controller:"SuggestCtrl",templateUrl:"suggest/suggest_tpl.html",controllerAs:"vm"}}})}angular.module("index",["ui.router","ui.bootstrap","ngAnimate","ngSanitize","ngTouch","angularPromiseButtons"]).config(t),t.$inject=["$stateProvider","$locationProvider","$httpProvider","$urlRouterProvider","angularPromiseButtonsProvider"]}();var host="https://www.bookist.org",statusDict={create:"创建",pending:"待发货",waiting:"待收货",commenting:"待评价",done:"已完成",canceled:"已取消",refund:"申请退款中",refunding:"退款中",refunded:"退款完成",replace:"申请换货中",replacing:"换货中",replaced:"换货完成",refund_refused:"退款失败",replace_refused:"换货失败",closed:"已关闭"};notie.setOptions({colorSuccess:"#57BF57",colorWarning:"#D6A14D",colorError:"#E1715B",colorInfo:"#4D82D6",colorNeutral:"#A0A0A0",colorText:"#FFFFFF",animationDelay:300,backgroundClickDismiss:!0});var notices={216:"加入购物车成功"};!function(){var t=function(){return{restrict:"EA",replace:!0,scope:{books:"=",scroll:"="},template:'\n    <div class="books-content" infinite-scroll=\'scroll.nextPage()\'\n         infinite-scroll-disabled=\'scroll.busy\'\n         infinite-scroll-distance=\'1\'>\n        <a class="books-content-list" ng-repeat="book in books" ui-sref="book({isbn: book.isbn})">\n            <img ng-src="{{book.image}}">\n            <span class="title">{{book.title}}</span>\n            <uib-rating class="star red-star wechat-fix"\n                        ng-model="book.star"\n                        max="5" read-only="true"\n                        state-on="\'fa fa-star\'" state-off="\'fa fa-star-o\'"></uib-rating>\n            <span class="rate">&nbsp;{{book.rate}}</span>\n            <blockquote class="reason" ng-bind-html="book.reason"></blockquote>\n        </a>\n        <div class="loading-more" ng-if="scroll.busy"><i class="fa fa-spinner fa-pulse fa-2x"></i></div>\n    </div>\n            '}};angular.module("index").directive("bookRow",t)}(),function(){var t=function(){return{restrict:"EA",replace:!0,scope:{books:"="},template:'\n             <div class="slides-book-content">\n                <a ng-repeat="book in books track by $index" ui-sref="book({isbn: book.isbn})">\n                    <img ng-src="{{book.image}}">\n                    <p>{{book.title}}</p>\n                    <uib-rating ng-model="book.star"\n                                class="red-star wechat-fix"\n                                state-on="\'fa fa-star\'"\n                                state-off="\'fa fa-star-o\'"\n                                max="5" \n                                read-only="true"></uib-rating>\n                    <span>{{book.rate | number:1}}</span>\n                </a>\n            </div>\n                '}};angular.module("index").directive("bookSlide",t)}(),function(){var t=function(){return{restrict:"EA",replace:!0,scope:{booklists:"=",scroll:"="},template:'       \n           <div class="booklists-row"  infinite-scroll=\'scroll.nextPage()\' \n                infinite-scroll-disabled=\'scroll.busy\'  infinite-scroll-distance=\'1\'>\n                <a class="booklist" ng-repeat="booklist in booklists" ui-sref="booklist({id: booklist.id})">\n                    <div class="pic">\n                        <img ng-src="{{booklist.image}}">\n                    </div>\n                    <span class="title">{{booklist.title}}</span>\n                    <span class="collect">{{booklist.collect}}人收藏</span>\n                    <div class="tags">\n                        <div class="tag" ng-repeat="tag in booklist.tags">\n                            {{tag}}\n                        </div>\n                    </div>\n                </a>\n            </div>\n            '}};angular.module("index").directive("booklistRow",t)}(),function(){var t=function(){return{restrict:"EA",replace:!0,scope:{comment:"=",up:"=",down:"="},template:'\n                    <div>\n                    <div class="origin">\n                        <img ng-src="{{comment.user.avatar}}">\n                        <span>{{comment.user.username}}</span>\n                        <uib-rating class="star red-star"\n                            ng-model="comment.star"\n                            state-on="\'fa fa-star\'"\n                            state-off="\'fa fa-star-o\'"\n                            max="5" read-only="true"></uib-rating>\n                    </div>\n                    <p ng-bind-html="comment.content"></p>\n                    <div class="comment-meta">\n                            <p>{{comment.create_time*1000 | date:\'yyyy-MM-dd HH:mm\'}}</p>\n                        <i class="fa"\n                            ng-class={false:\'fa-thumbs-o-down\',true:\'fa-thumbs-down\'}[comment.down_already]\n                            ng-click="down(comment)">\n                            {{comment.down}}\n                        </i>\n                        <i class="fa"\n                            ng-class={false:\'fa-thumbs-o-up\',true:\'fa-thumbs-up\'}[comment.up_already]\n                            ng-click="up(comment)">\n                            {{comment.up}}\n                        </i>\n                    </div>\n                    </div>\n                '}};angular.module("index").directive("commentRow",t)}(),function(){var t=function(){return{restrict:"EA",replace:!0,scope:{stars:"=",title:"@"},template:'\n                    <div>\n                    <span>{{title}}</span>\n                    <uib-rating ng-model="stars" max="5"\n                                read-only="false"\n                                class="red-star star" required\n                                on-leave="overStar = null"\n                                state-on="\'fa fa-star\'" state-off="\'fa fa-star-o\'">                         \n                    </uib-rating>\n                    </div>\n                '}};angular.module("index").directive("commentStar",t)}(),function(){var t=function(){return{restrict:"EA",replace:!0,scope:{content:"=",commit:"&",cancel:"="},template:'\n            <div>\n            <div class="modal-dialog">\n                <div class="modal-header">\n                    <h4 class="modal-title">你确认要删除吗?</h4>\n                </div>\n                <div class="modal-body">\n                    <p>{{content}}</p>\n                </div>\n                <div class="modal-footer">\n                    <button class="btn btn-primary" promise-btn\n                            ng-click="commit()">确认</button>\n                    <button class="btn btn-warning"\n                            ng-click="cancel = false">取消</button>\n                </div>\n            </div>\n            <div class="modal-backdrop fade" style="z-index: 1040;"></div>\n            </div>\n            '}};angular.module("index").directive("deleteBox",t)}(),function(){function t(t){return{scope:{trigger:"@focusMe"},link:function(e,n){e.$watch("trigger",function(e){"true"===e&&t(function(){n[0].focus()})})}}}angular.module("index").directive("focusMe",t),t.$inject=["$timeout"]}(),function(){var t=function(){return{require:"ngModel",link:function(t,e,n,r){function o(t){if(t.length>i){var e=t.substring(0,i);return r.$setViewValue(e),r.$render(),e}return t}var i=Number(n.myMaxlength);r.$parsers.push(o)}}};angular.module("index").directive("myMaxlength",t)}(),function(){var t=function(){return{restrict:"AE",replace:!0,templateUrl:"navbar/navbar_tpl.html"}};angular.module("index").directive("navbar",t)}(),function(){var t=function(){return{restrict:"EA",replace:!0,scope:{title:"=",icon:"="},template:'\n            <div class="navbar navbar-default navbar-fixed-top topbar">\n                <a class="navbar-brand"><i class="fa fa-book"></i>\n                    {{title}}</a>\n            </div>\n            '}};angular.module("index").directive("topBar",t)}(),function(){function t(t,e){function n(e){return t.post(host+"/collect",{type:"booklist",id:e}).then(function(t){return t.data})}function r(e){return void 0===s[e]?t.get(host+"/booklist?id="+e).then(function(t){return s[e]=t.data,s[e]}):(a.resolve(s[e]),a.promise)}function o(){return t.get(host+"/booklist?type=hot").then(function(t){return t.data})}function i(e,n){return this.list=[],this.busy=!1,this.url=host+"/booklist",this.params={type:e,page:1},void 0!==n&&(this.params.tag=n),this["continue"]=!0,this.nextPage=function(){return this["continue"]?void(this.busy||(this.busy=!0,t({method:"GET",url:this.url,params:this.params}).success(function(t){var e=t;e.length<5&&(this["continue"]=!1);for(var n=0;n<e.length;n++)e[n].star=Math.ceil(e[n].rate/2),this.list.push(e[n]);this.busy=!1,this.params.page+=1}.bind(this)))):void(this.busy=!1)}.bind(this),this.nextPage(),this}var s=[],a=e.defer();return{collectBooklist:n,getHotBooklists:o,getBooklistDetail:r,getBooklists:i}}angular.module("index").factory("booklistservice",t),t.$inject=["$http","$q"]}(),function(){function t(t,e,n){function r(){return this.list=[],this.busy=!1,this.url=host+"/pop_book",this.params={page:1},this["continue"]=!0,this.nextPage=function(){return this["continue"]?void(this.busy||(this.busy=!0,t({method:"GET",url:this.url,params:this.params}).success(function(t){var e=t;e.length<5&&(this["continue"]=!1);for(var n=0;n<e.length;n++)e[n].star=Math.ceil(e[n].rate/2),this.list.push(e[n]);this.busy=!1,this.params.page+=1}.bind(this)))):void(this.busy=!1)}.bind(this),this.nextPage(),this}function o(e){if(void 0===m[e])return t.get(host+"/book?type=detail&isbn="+e).then(function(t){return m[e]=t.data,m[e]});var r=n.defer();return r.resolve(m[e]),r.promise}function i(e){return t.get(host+"/booklist?isbn="+e).then(function(t){return t.data})}function s(e){if(null==f[e])return t.get(host+"/similar_book?isbn="+e).then(function(t){return f[e]=h(t.data),f[e]});var r=n.defer();return r.resolve(f[e]),r.promise}function a(e){return t.post(host+"/collect",{isbn:e,type:"book"}).then(function(t){return t.data})}function l(e){return t.post(host+"/collect",{type:"book",isbn:e}).then(function(t){return t.data})}function c(e){return t.get(host+"/book?isbn="+e).then(function(t){return h(t.data)})}function u(){if(null===d)return t.get(host+"/pop_book").then(function(t){return d=h(t.data)});var e=n.defer();return e.resolve(d),e.promise}var d=null,m=[],f=[],h=e.changeStars;return{getPopularBooks:u,getBook:c,getBookDetail:o,collectBook:a,discollectBook:l,getSimilarBook:s,getBookBelongs:i,getBooks:r}}angular.module("index").factory("bookservice",t),t.$inject=["$http","commonservice","$q"]}(),function(){function t(t){function e(e){return t.post(host+"/cart",{isbn:e}).then(function(t){return t.data})}function n(){return t.get(host+"/user_carts").then(function(t){return t.data})}function r(e,n){return t.put(host+"/cart",{isbn:e,number:n}).then(function(t){return t.data})}function o(e){return t["delete"](host+"/cart",{data:{isbn:e}}).then(function(t){return t.data})}return{getCart:n,addCart:e,updateCart:r,deleteCart:o}}angular.module("index").factory("cartservice",t),t.$inject=["$http"]}(),function(){function t(t,e){function n(){return d}function r(t){d=t}function o(e,n,r){return t.post(host+"/user_billing",{stars1:2*e,stars2:2*n,stars3:2*r}).then(function(t){return t.data})}function i(e){return t.get(host+"/comments?isbn="+e).then(function(t){return m(t.data)})}function s(e){return t["delete"](host+"/comment",{data:{id:e}}).then(function(t){return t.data})}function a(e,n,r){return t.put(host+"/comment",{id:e,star:n,content:r,type:"edit"}).then(function(t){return t.data})}function l(e,n,r){return t.post(host+"/comment",{content:r,star:2*n,isbn:e}).then(function(t){return t.data})}function c(e){return t.put(host+"/comment",{id:e,type:"up"}).then(function(t){return t.data})}function u(e){return t.put(host+"/comment",{id:e,type:"down"}).then(function(t){return t.data})}var d=null,m=e.changeStars;return{up:c,down:u,postComment:l,editComment:a,deleteComment:s,getComment:i,platformComment:o,getTitle:n,setTitle:r}}angular.module("index").factory("commentservice",t),t.$inject=["$http","commonservice"]}(),function(){function t(t){function e(t){if(t instanceof Array){var e=!0,n=!1,r=void 0;try{for(var o,i=t[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var s=o.value;s.rate?s.star=Math.ceil(s.rate/2):s.star&&(s.star=Math.ceil(s.star/2))}}catch(a){n=!0,r=a}finally{try{!e&&i["return"]&&i["return"]()}finally{if(n)throw r}}return t}return void 0!==t.rate&&(t.rate?t.star=Math.ceil(t.rate/2):t.star&&(t.star=Math.ceil(t.star/2))),t}return{changeStars:e}}angular.module("index").factory("commonservice",t),t.$inject=["$http"]}(),function(){function t(t){function e(e){return t.get(host+"/user_billings?status="+e).then(function(t){return t.data})}function n(){return t.get(host+"/billing?status=on_return").then(function(t){return t.data})}function r(e){return t.put(host+"/billing",{id:e,status:"commenting"}).then(function(t){return t.data})}function o(e){return t["delete"](host+"/billing",{data:{id:e}}).then(function(t){return t.data})}function i(e){return t.get(host+"/billing?id="+e).then(function(t){return t.data})}function s(e,n){return t.post(host+"/billing",{cart_list:e,address_id:n}).then(function(t){return t.data})}function a(t){c=t}function l(){return c}var c=null;return{setStore:a,getStore:l,makeOrder:s,getOrderDetail:i,cancelOrder:o,receiptOrder:r,getReturnOrder:n,getOrder:e}}angular.module("index").factory("orderservice",t),t.$inject=["$http"]}(),function(){function t(t,e){function n(){return null===r?t.get(host+"/slides").then(function(t){return r=t.data}):(o.resolve(r),o.promise)}var r=null,o=e.defer();return{getSlides:n}}angular.module("index").factory("slideservice",t),t.$inject=["$http","$q"]}(),function(){function t(t,e){function n(){if(null==i)return t.get(host+"/tags?type=all").then(function(t){return i=t.data});var n=e.defer();return n.resolve(i),n.promise}function r(){if(null==o)return t.get(host+"/tags?type=hot").then(function(t){return o=t.data});var n=e.defer();return n.resolve(o),n.promise}var o=null,i=null;return{getHotTags:r,getAllTags:n}}angular.module("index").factory("tagservice",t),t.$inject=["$http","$q"]}(),function(){function t(){return{request:function(t){return t.requestTimestamp=(new Date).getTime(),t},response:function(t){return t.config.responseTimestamp=(new Date).getTime(),t}}}angular.module("index").factory("timestampMarker",t)}(),function(){function t(t,e,n){return{request:function(r){var o=host+"/auth_verify",i=e.defer(),s=t.get("$http");if(r.url===o)return r;if("true"===sessionStorage.verify){var a=(new Date).getTime()/1e3;a-localStorage.getItem("createdtime")>=7100&&(sessionStorage.verify=!1),r.headers.token=localStorage.getItem("token"),r.headers.userid=localStorage.getItem("user_id"),i.resolve(r)}else s({method:"GET",url:o,params:{token:localStorage.getItem("token"),user_id:localStorage.getItem("user_id")}}).success(function(t){localStorage.setItem("token",t.token),localStorage.setItem("createdtime",t.time),sessionStorage.verify="true",r.headers.token=localStorage.getItem("token"),r.headers.userid=localStorage.getItem("user_id"),n.log("verify OK"),i.resolve(r)}).error(function(){n.log("verify FAIL"),i.resolve(r)});return i.promise}}}angular.module("index").factory("tokenInjector",t),t.$inject=["$injector","$q","$log"]}(),function(){function t(t,e,n){function r(){if(null==b)return t.get(host+"/user_address?type=default").then(function(t){return b=t.data});var e=n.defer();return e.resolve(b),e.promise}function o(e){return t.get(host+"/user_collects?type="+e).then(function(t){return g(t.data)})}function i(e,n,r,o){var i={name:e,phone:n,dormitory:r,type:"default",id:o};return t.put(host+"/user_address",i).then(function(t){200==t.status&&(b=i)})}function s(e){return t["delete"](host+"/user_address",{data:{id:e}}).then(function(t){200==t.status&&(b=null)})}function a(e,n,r,o){return t.put(host+"/user_address",{name:e,phone:n,dormitory:r,id:o}).then(function(t){return t.data})}function l(e,n,r){return t.post(host+"/user_address",{name:e,phone:n,dormitory:r}).then(function(t){return t.data})}function c(t){k=t}function u(){return k}function d(){return t.get(host+"/user_address").then(function(t){return t.data})}function m(){return t.get(host+"/user_comments").then(function(t){return t.data})}function f(e){return t.post(host+"/user_feedback",{content:e}).then(function(t){return t.data})}function h(){return t.get(host+"/user_points").then(function(t){return t.data})}function p(){if(null==y)return t.get(host+"/user_info").then(function(t){return y=t.data});var e=n.defer();return e.resolve(y),e.promise}function v(){return t.get(host+"/user_notices").then(function(t){return t.data})}var g=e.changeStars,b=null,k=null,y=null;return{getUserInfo:p,getUserNotices:v,getUserPoints:h,getUserComments:m,getUserCollect:o,postSuggestion:f,getUserAddress:d,updateUserAddress:a,deleteUserAddress:s,addUserAddress:l,setUserDefaultAddress:i,getUserDefaultAddress:r,setAddress:c,getAddress:u}}angular.module("index").factory("userservice",t),t.$inject=["$http","commonservice","$q"]}(),function(){function t(t,e){function n(){t.getBookDetail(e.isbn).then(function(t){r.book=t})}var r=this;n()}angular.module("index").controller("BookInfoCtrl",t),t.$inject=["bookservice","$stateParams"]}(),function(){function t(t,e){function n(){e.getComment(t.isbn).then(function(t){i.comments=t})}function r(t){e.up(t.id).then(function(){t.down=t.down_already?--t.down:t.down,t.up_already=!t.up_already,t.down_already=!1,t.up=t.up_already?++t.up:--t.up})}function o(t){e.down(t.id).then(function(){t.up=t.up_already?--t.up:t.up,t.down_already=!t.down_already,t.up_already=!1,t.down=t.down_already?++t.down:--t.down})}var i=this;i.title=e.getTitle(),i.up=r,i.down=o,n()}angular.module("index").controller("BooklistCommentsCtrl",t),t.$inject=["$stateParams","commentservice"]}(),function(){function t(t,e){function n(){e.getHotTags().then(function(t){i.tags=t})}function r(){i.booklists=new t.getBooklists("time"),i.booklists.nextPage()}function o(){i.booklists=new t.getBooklists("collect"),i.booklists.nextPage()}var i=this;i.booklists=new t.getBooklists("all"),i.timeOrder=r,i.collectOrder=o,n()}angular.module("index").controller("BooklistsCtrl",t),t.$inject=["booklistservice","tagservice"]}(),function(){function t(t,e,n,r){function o(){e.getCart().then(function(t){v.items=t;var e=1,n=!0,r=!1,o=void 0;try{for(var i,s=v.items[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var a=i.value;a.checked=!1,a.index=e++,a.deleted=!1}}catch(l){r=!0,o=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(r)throw o}}v.recount(v.items)})}function i(){v.price=0,v.count=0,v.number=0;var t=!0,e=!1,n=void 0;try{for(var r,o=v.items[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;i.deleted||(v.price+=+i.checked*i.price*i.number,v.count+=+i.checked*i.number,i.checked?++v.number:v.number)}}catch(s){e=!0,n=s}finally{try{!t&&o["return"]&&o["return"]()}finally{if(e)throw n}}}function s(){var t=!0,e=!1,n=void 0;try{for(var r,o=v.items[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;i.checked=v.checked}}catch(s){e=!0,n=s}finally{try{!t&&o["return"]&&o["return"]()}finally{if(e)throw n}}v.recount()}function a(t){t.number<10?++t.number:t.number,e.updateCart(t.book.isbn,t.number).then(function(){v.recount()})}function l(t){t.number>1?--t.number:t.number,e.updateCart(t.book.isbn,t.number).then(function(){v.recount()})}function c(){var t=!0,e=!1,n=void 0;try{for(var r,o=v.items[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;v.checkArr[i.book.isbn]=i.checked,i.checked=!1}}catch(s){e=!0,n=s}finally{try{!t&&o["return"]&&o["return"]()}finally{if(e)throw n}}v.recount(),v.editStatu=!0}function u(){var t=!0,e=!1,n=void 0;try{for(var r,o=v.items[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value;i.checked=v.checkArr[i.book.isbn]||!1}}catch(s){e=!0,n=s}finally{try{!t&&o["return"]&&o["return"]()}finally{if(e)throw n}}v.recount(),v.editStatu=!1}function d(t){t.checked=!1,t.deleted=!0,e.deleteCart(t.book.isbn),v.recount()}function m(){v.isbn_list="";var t=!0,n=!1,r=void 0;try{for(var o,i=v.items[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var s=o.value;s.checked&&!s.deleted&&(v.isbn_list+=v.isbn_list?","+s.book.isbn:s.book.isbn,s.deleted=!0)}}catch(a){n=!0,r=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(n)throw r}}return e.deleteCart(v.isbn_list).then(function(){v.recount()})}function f(){v.isbn_list="",v.isbn_list_collect="";var t=!0,r=!1,o=void 0;try{for(var i,s=v.items[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var a=i.value;a.checked&&!a.deleted&&(v.isbn_list+=v.isbn_list?","+a.book.isbn:a.book.isbn,a.book.is_collection&&(v.isbn_list_collect+=v.isbn_list_collect?","+a.book.isbn:a.book.isbn),a.deleted=!0,a.checked=!1)}}catch(l){r=!0,o=l}finally{try{!t&&s["return"]&&s["return"]()}finally{if(r)throw o}}return e.deleteCart(v.isbn_list),v.recount(),n.collectBook(v.isbn_list)}function h(t){t.number>10&&(t.number=10),t.number<=0&&(t.number=1),e.updateCart(t.book.isbn,t.number).then(function(){v.recount()})}function p(){var e=[],n=!0,o=!1,i=void 0;try{for(var s,a=v.items[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var l=s.value;l.checked&&!l.deleted&&e.push(l)}}catch(c){o=!0,i=c}finally{try{!n&&a["return"]&&a["return"]()}finally{if(o)throw i}}r.setStore(e),t.go("cart2order")}var v=this;v.checked=!1,v.editStatu=!1,v.price=0,v.count=0,v.number=0,v.checkArr=[],v.recount=i,v.selectAll=s,v.editOk=u,v.plus=a,v.minus=l,v.edit=c,v.collect=f,v.removeBook=d,v.removeBooks=m,v.cart2order=p,v.editBook=h,o()}angular.module("index").controller("CartCtrl",t),t.$inject=["$state","cartservice","bookservice","orderservice"]}(),function(){function t(t,e){function n(){e.getBooklistDetail(t.id).then(function(t){o.booklist=t;var e=!0,n=!1,r=void 0;try{for(var i,s=o.booklist.books[Symbol.iterator]();!(e=(i=s.next()).done);e=!0){var a=i.value;a.star=Math.ceil(a.rate/2)}}catch(l){n=!0,r=l}finally{try{!e&&s["return"]&&s["return"]()}finally{if(n)throw r}}})}function r(){return o.wait=!0,e.collectBooklist(t.id).then(function(){o.booklist.collect_already=!o.booklist.collect_already,o.booklist.collect=o.booklist.collect_already?++o.booklist.collect:--o.booklist.collect,o.wait=!1})}var o=this;o.wait=!1,o.wait2=!1,o.collect=r,n()}angular.module("index").controller("BookListCtrl",t),t.$inject=["$stateParams","booklistservice"]}(),function(){function t(t,e,n){function r(){e.getUserDefaultAddress().then(function(t){i.x=t[0],i.no_address=!1})["catch"](function(){i.no_address=!0})}function o(){return n.makeOrder(i.cart_list,i.x.id).then(function(e){t.path("/order/"+e+"/detail").replace()})}var i=this;i.no_address=!0,i.cart_list="",i.order={number:0,price:0},i.make=o,i.books=n.getStore();var s=!0,a=!1,l=void 0;try{for(var c,u=i.books[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var d=c.value;i.order.number+=d.number,i.order.price+=d.price*d.number,i.cart_list+=i.cart_list?","+d.id:d.id}}catch(m){a=!0,l=m}finally{try{!s&&u["return"]&&u["return"]()}finally{if(a)throw l}}r()}angular.module("index").controller("Cart2OrderCtrl",t),t.$inject=["$location","userservice","orderservice"]}(),function(){function t(t,e,n,r,o){function i(){return r.addCart(t.isbn)}function s(){return n.collectBook(t.isbn).then(function(){u.book.collect_already=!u.book.collect_already})}function a(t){e.up(t.id).then(function(){t.down=t.down_already?--t.down:t.down,t.up_already=!t.up_already,t.down_already=!1,t.up=t.up_already?++t.up:--t.up})}function l(t){e.down(t.id).then(function(){t.up=t.up_already?--t.up:t.up,t.down_already=!t.down_already,t.up_already=!1,t.down=t.down_already?++t.down:--t.down})}function c(){if(void 0!==u.content)return e.postComment(t.isbn,u.star,u.content).then(function(t){u.commentBox=!1,t.user={avatar:u.user.avatar,username:u.user.username},t.star=t.star/2,u.book.commenters++,u.book.comments.push(t),u.content=""})}var u=this;u.more=!1,u.required=!0,u.star=5,u.addCart=i,u.collect=s,u.postComment=c,u.up=a,u.down=l,n.getBook(t.isbn).then(function(t){u.book=t,e.setTitle(u.book.title)}),o.getUserInfo().then(function(t){u.user=t}),n.getSimilarBook(t.isbn).then(function(t){u.similarbooks=t}),n.getBookBelongs(t.isbn).then(function(t){u.booklists=t})}angular.module("index").controller("BookCtrl",t),t.$inject=["$stateParams","commentservice","bookservice","cartservice","userservice"]}(),function(){function t(t){function e(){t.getUserCollect("booklist").then(function(t){n.booklists=t})}var n=this;e()}angular.module("index").controller("CollectBookListsCtrl",t),t.$inject=["userservice"]}(),function(){function t(t,e){function n(){t.getUserCollect("book").then(function(t){o.books=t;var e=!0,n=!1,r=void 0;try{for(var i,s=o.books[Symbol.iterator]();!(e=(i=s.next()).done);e=!0){var a=i.value;a.star=Math.ceil(a.rate/2)}}catch(l){n=!0,r=l}finally{try{!e&&s["return"]&&s["return"]()}finally{if(n)throw r}}})}function r(t,n){e.discollectBook(t.isbn).then(function(){o.books.splice(n,1)})}var o=this;o.remove=r,n()}angular.module("index").controller("CollectBooksCtrl",t),t.$inject=["userservice","bookservice"]}(),function(){function t(t,e,n,r){function o(){t.getPopularBooks().then(function(t){a.books=t})}function i(){e.getHotBooklists().then(function(t){a.booklists=t})}function s(){n.getSlides().then(function(t){a.slides=t,r.log(t)})}var a=this;a.myInterval=5e3,o(),i(),s()}angular.module("index").controller("IndexCtrl",t),t.$inject=["bookservice","booklistservice","slideservice","$log"]}(),function(){function t(t,e){function n(){e.getComment(t.isbn).then(function(t){i.comments=t})}function r(t){e.up(t.id).then(function(){t.down=t.down_already?--t.down:t.down,t.up_already=!t.up_already,t.down_already=!1,t.up=t.up_already?++t.up:--t.up})}function o(t){e.down(t.id).then(function(){t.up=t.up_already?--t.up:t.up,t.down_already=!t.down_already,t.up_already=!1,t.down=t.down_already?++t.down:--t.down})}var i=this;i.title=e.getTitle(),i.up=r,i.down=o,n()}angular.module("index").controller("CommentsCtrl",t),t.$inject=["$stateParams","commentservice"]}(),function(){function t(t){function e(){t.getUserInfo().then(function(t){n.user=t})}var n=this;e()}angular.module("index").controller("MeCtrl",t),t.$inject=["userservice"]}(),function(){function t(t){function e(){t.getUserNotices().then(function(t){n.notices=t})}var n=this;e()}angular.module("index").controller("NoticesCtrl",t),t.$inject=["userservice"]}(),function(){function t(t,e,n,r){function o(){n.getOrderDetail(e.id).then(function(t){s.order=t,"commenting"!==s.order.status&&history.back()})}function i(){var e=[];if(!s.commentForm.$valid)return void notie.alert(1,"请填写全部信息",.3);var n=!0,o=!1,i=void 0;try{for(var a,l=s.order.carts[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=a.value;e.push(r.postComment(c.book.isbn,c.book.star,c.book.content))}}catch(u){o=!0,i=u}finally{try{!n&&l["return"]&&l["return"]()}finally{if(o)throw i}}return t.all(e).then(function(){r.platformComment(s.stars1,s.stars2,s.stars3)}).then(function(){history.back()})}var s=this;s.comment=i,o()}angular.module("index").controller("OrderCommentsCtrl",t),t.$inject=["$q","$stateParams","orderservice","commentservice"]}(),
function(){function t(t,e){function n(){e.getOrderDetail(t.id).then(function(t){i.order=t,i.order.status=statusDict[i.order.status];var e=!0,n=!1,r=void 0;try{for(var o,s=i.order.carts[Symbol.iterator]();!(e=(o=s.next()).done);e=!0){var a=o.value;i.price+=a.number*a.price}}catch(l){n=!0,r=l}finally{try{!e&&s["return"]&&s["return"]()}finally{if(n)throw r}}var c=!0,u=!1,d=void 0;try{for(var m,f=i.order.status_list[Symbol.iterator]();!(c=(m=f.next()).done);c=!0){var h=m.value;i.status_list.push({status:statusDict[h.status],content:h.content,time:h.time})}}catch(l){u=!0,d=l}finally{try{!c&&f["return"]&&f["return"]()}finally{if(u)throw d}}})}function r(t){return e.cancelOrder(t.id).then(function(){i.order.status="已取消",i.status_list.push({status:"已取消",time:Date.parse(new Date)/1e3})})}function o(t){return e.receiptOrder(t.id).then(function(){i.status_list.push({status:"已收货",time:Date.parse(new Date)/1e3}),i.order.status="待评价"})}var i=this;i.price=0,i.status_list=[],i.cancel=r,i.receipt=o,n()}angular.module("index").controller("OrderDetailCtrl",t),t.$inject=["$stateParams","orderservice"]}(),function(){function t(t,e){function n(){e.getOrder(t.status).then(function(t){s.orders=t;var e=!0,n=!1,r=void 0;try{for(var o,i=s.orders[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value;a.status=statusDict[a.status]}}catch(l){n=!0,r=l}finally{try{!e&&i["return"]&&i["return"]()}finally{if(n)throw r}}})}function r(t){}function o(t){return e.cancelOrder(t.id).then(function(){t.status="已取消"})}function i(t){return e.receiptOrder(t.id).then(function(){t.status="待评价"})}var s=this;s.WAIT_OPERATING=!1,s.type=t.status;var a=["pending","all","commenting","waiting","return","done"];s.cancelReturn=r,s.cancel=o,s.receipt=i,n(),a.indexOf(s.type)===-1?history.back():"return"===s.type&&e.getReturnOrder().then(function(t){s.orders_return=t;var e=!0,n=!1,r=void 0;try{for(var o,i=s.orders_return[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value;a.status=statusDict[a.status]}}catch(l){n=!0,r=l}finally{try{!e&&i["return"]&&i["return"]()}finally{if(n)throw r}}})}angular.module("index").controller("OrdersCtrl",t),t.$inject=["$stateParams","orderservice"]}(),function(){function t(t){function e(){t.getUserPoints().then(function(t){n.points=t})}var n=this;e()}angular.module("index").controller("PointCtrl",t),t.$inject=["userservice"]}(),function(){function t(t){var e=this;e.booklists=new t.getBooklists("all"),e.booklists.nextPage()}angular.module("index").controller("PopularMoreCtrl",t),t.$inject=["booklistservice"]}(),function(){function t(t){var e=this;e.books=new t.getBooks,e.books.nextPage()}angular.module("index").controller("RecommendMoreCtrl",t),t.$inject=["bookservice"]}(),function(){function t(t,e){function n(){e.getUserAddress().then(function(t){i.address=t})}function r(n){i.edit=function(){e.setAddress(n),t.go("AddressAdd")}}function o(){history.back()}var i=this;i.edit=r,i.back=o,n()}angular.module("index").controller("AddressCtrl",t),t.$inject=["$state","userservice"]}(),function(){function t(t){function e(){return!!s()&&t.updateUserAddress(a.name,a.phone,a.dormitory,a.id).then(function(){a.back()})}function n(){return!!s()&&t.addUserAddress(a.name,a.phone,a.dormitory).then(function(){a.back()})}function r(e){return t.deleteUserAddress(e).then(function(){a.back()})}function o(e){return t.setUserDefaultAddress(a.name,a.phone,a.dormitory,e).then(function(){a.back()})}function i(){history.back()}function s(){return+a.addressForm.phone.$viewValue?!a.addressForm.$invalid||(a.addressForm.name.$invalid?(a.correct_name=!0,notie.alert(1,"收货人信息有误",.3)):a.addressForm.phone.$invalid?(a.correct_phone=!0,notie.alert(1,"手机信息有误",.3)):a.addressForm.dorm.$invalid&&(a.correct_dorm=!0,notie.alert(1,"宿舍信息有误",.3)),!1):(a.correct_phone=!0,notie.alert(1,"手机信息有误",.3),!1)}var a=this;a.data=t.getAddress(),null===a.data?a.edit=!1:(a.phone=a.data.phone,a.dormitory=a.data.dormitory,a.name=a.data.name,a.id=a.data.id,a.edit=!0,t.setAddress(null)),a.addAddress=n,a.updateAddress=e,a.deleteAddress=r,a.setDefaultAddress=o,a.back=i}angular.module("index").controller("AddressAddCtrl",t),t.$inject=["userservice"]}(),function(){function t(t){function e(){t.getUserInfo().then(function(t){n.user=t})}var n=this;e()}angular.module("index").controller("SettingsCtrl",t),t.$inject=["userservice"]}(),function(){function t(t,e){function n(){t.getUserInfo().then(function(t){o.user=t})}function r(){if(void 0!==o.suggestion&&""!=o.suggestion)return t.postSuggestion(o.suggestion).then(function(){notie.alert(1,"谢谢您的反馈！",.3),e(function(){history.back()},300)})}var o=this;o.post=r,n()}angular.module("index").controller("SuggestCtrl",t),t.$inject=["userservice","$timeout"]}(),function(){function t(t,e){function n(){i.booklists=new e.getBooklists("all",t.tag),i.booklists.nextPage()}function r(){i.booklists=new e.getBooklists("time",t.tag),i.booklists.nextPage()}function o(){i.booklists=new e.getBooklists("collect",t.tag),i.booklists.nextPage()}var i=this;n(),i.timeOrder=r,i.collectOrder=o}angular.module("index").controller("TagBooklistsCtrl",t),t.$inject=["$stateParams","booklistservice"]}(),function(){function t(t,e){function n(){t.getUserComments().then(function(t){s.comments=t;var e=!0,n=!1,r=void 0;try{for(var o,i=s.comments[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value;a.readonly=!0,a.deleteBox=!1}}catch(l){n=!0,r=l}finally{try{!e&&i["return"]&&i["return"]()}finally{if(n)throw r}}})}function r(t){t.readonly=!1,t.edit=!0}function o(t){if(void 0!==t.content&&""!=t.content)return e.editComment(t.id,t.star,t.content).then(function(){t.readonly=!0,t.edit=!1})}function i(t){return e.deleteComment(t.id).then(function(){s.comments.splice(s.comments.indexOf(t),1),s.deleteBox=!1})}var s=this;s.deleteBox=!1,s.edit=!1,s.readonly=!0,s.focus=r,s.submit=o,s["delete"]=i,n()}angular.module("index").controller("UserCommentsCtrl",t),t.$inject=["userservice","commentservice"]}(),function(){function t(t){var e=this;t.getAllTags().then(function(t){e.allTags=t})}angular.module("index").controller("TagsCtrl",t),t.$inject=["tagservice"]}();
;(function(){

'use strict';

angular.module('index').run(['$templateCache', function($templateCache) {

  $templateCache.put('book/book_core_part.html', '<div class="book-intro"><span>简介</span><p ng-bind-html="vm.book.description" ng-class="{\'book-intro-less\':!vm.more,\'book-intro-more\':vm.more}"></p><span class="btn btn-block btn-default" ng-show="!vm.more" ng-click="vm.more=!vm.more">更多</span> <span class="btn btn-block btn-default" ng-show="vm.more" ng-click="vm.more=!vm.more">收起</span></div><div class="book-comments"><span>评论</span><div class="book-no-comment" ng-if="vm.book.comments.length == 0"><p style="color: grey">征集评论</p></div><div class="book-comment" ng-repeat="comment in vm.book.comments" ng-if="book.comments.length != 0"><comment-row comment="comment" up="vm.up" down="vm.down"></comment-row></div><div class="book-comments-more"><a class="btn btn-default" ui-sref="commentsBook({isbn: vm.book.isbn, title: vm.book.title})">全部评论</a> <button class="btn btn-default" ng-click="vm.commentBox=!vm.commentBox;">我要评论</button></div><form name="commentForm" class="book-comment-box" ng-if="vm.commentBox"><div class="book-comment-origin"><img ng-src="{{vm.user.avatar}}"> <span class="book-comment-origin">{{vm.user.username}}</span><uib-rating class="star red-star" state-on="\'fa fa-star\'" state-off="\'fa fa-star-o\'" ng-model="vm.star" max="5" read-only="false"></uib-rating></div><textarea ng-model="vm.content" focus-me="{{vm.commentBox}}" name="content" class="form-control" rows="3" ng-required="true"></textarea><div class="book-comment-post"><p>评价 "{{vm.book.title}}"</p><button class="btn btn-success" type="submit" ng-click="vm.postComment()" promise-btn>发表</button></div></form></div>');

  $templateCache.put('book/book_head_part.html', '<div class="book-image"><img class="cover" ng-src="{{vm.book.image}}"> <img class="cover-bg" ng-src="{{vm.book.image}}"></div><div class="book-info"><h3>{{vm.book.title}}</h3><div class="book-info-rate"><uib-rating class="star wechat-fix" ng-model="vm.book.star" max="5" read-only="true" state-on="\'fa fa-star\'" state-off="\'fa fa-star-o\'"></uib-rating><span class="rate">{{vm.book.rate | number:1 }}</span> <span class="collect">({{vm.book.commenters}}人评价)</span> <a class="book-info-more-option" ui-sref="bookDetail({isbn: vm.book.isbn})"><i class="fa fa-chevron-right"></i></a></div><div class="book-info-basic"><span class="author" ng-if=\'vm.book.author!=""\'><span ng-repeat="x in vm.book.author track by $index">{{x}}</span>/</span> <span class="publisher" ng-if=\'vm.book.publisher!=""\'>{{book.publisher}} /</span> <span class="publish_time" ng-if=\'vm.book.publish_time!=""\'>{{book.publish_time}}</span></div></div>');

  $templateCache.put('book/book_other_part.html', '<div class="books-similarity" ng-if="vm.similarbooks.length != 0"><span>购买此书的人最近也购买</span><book-slide books="vm.similarbooks"></book-slide></div><div class="booklists-box" ng-if="vm.booklists.length != 0"><span style="padding:0 10px">被以下书单收录</span><booklist-row booklists="vm.booklists"></booklist-row></div>');

  $templateCache.put('book/book_section_part.html', '<span name="price">¥ {{vm.book.price | number:2 }}</span> <button class="btn btn-success" ng-click="vm.collect()" promise-btn><i ng-if="!vm.book.collect_already" class="fa fa-bookmark-o"></i> <i ng-if="vm.book.collect_already" class="fa fa-bookmark"></i> <i>收藏</i></button> <button class="btn btn-danger" ng-click="vm.addCart()" promise-btn><i class="fa fa-cart-plus"></i> <i>加入购物车</i></button>');

  $templateCache.put('book/book_tpl.html', '<div class="book-page"><div class="book-detail"><div class="book-head" ng-include="\'book/book_head_part.html\'"></div><div class="book-section" ng-include="\'book/book_section_part.html\'"></div><div class="book" ng-include="\'book/book_core_part.html\'"></div><div ng-include="\'book/book_other_part.html\'"></div></div></div>');

  $templateCache.put('book_info/book_info_tpl.html', '<div class="book-info-page"><div class="book"><header>出版信息</header><article><section><span class="info" ng-if=\'vm.book.title!=""\'>标题: {{vm.book.title}}</span> <span class="info" ng-if=\'vm.book.subtitle!=""\'>副标题: {{vm.book.subtitle}}</span> <span class="info" ng-if=\'vm.book.origin_title!=""\'>原标题: {{vm.book.origin_title}}</span> <span class="info" ng-if=\'vm.book.author!=""\'>作者：<span ng-repeat="x in vm.book.author">{{x}}</span></span> <span class="info" ng-if="vm.book.translator" !>译者: <span ng-repeat="x in vm.book.translator">{{x}}</span></span> <span class="info" ng-if=\'vm.book.publisher!=""\'>出版社: {{vm.book.publisher}}</span> <span class="info" ng-if=\'vm.book.publish_time!=""\'>出版年: {{vm.book.publish_time}}</span> <span class="info" ng-if="!vm.book.page">页数: {{vm.book.page}}</span> <span class="info" ng-if=\'vm.book.price!=""\'>定价: {{vm.book.price}}</span> <span class="info" ng-if=\'vm.book.binding!=""\'>装帧: {{vm.book.binding}}</span> <span class="info" ng-if=\'vm.book.isbn!=""\'>ISBN: {{vm.book.isbn}}</span></section></article></div><div class="book" ng-if=\'vm.book.description!=""\'><header>书籍内容介绍</header><article><section><p class="info" ng-bind-html="vm.book.description"></p></section></article></div><div class="book" ng-if=\'vm.book.author_intro!=""\'><header>作者介绍</header><article><section><p class="info" ng-bind-html="vm.book.author_description"></p></section></article></div><div class="book" ng-if=\'vm.book.catelog!=""\'><header>目录</header><article><section><p class="info" ng-bind-html="vm.book.catelog"></p></section></article></div></div>');

  $templateCache.put('booklist/booklist_head_part.html', '<div class="booklist-header"><img class="booklist-image-cover" ng-src="{{vm.booklist.image}}"><h3>{{vm.booklist.title}}</h3><p class="booklist-intro">{{vm.booklist.description}}</p><img class="avatar" ng-src="{{vm.booklist.author.avatar}}"> <small>{{vm.booklist.author.name}}</small></div><div class="tags"><div class="tags-outer"><div class="tags-inner"><span class="tag">标签</span> <a class="tag" ng-repeat="tag in vm.booklist.tags track by $index" ui-sref="tagBooklists({tag: tag})">{{tag}}</a></div></div></div>');

  $templateCache.put('booklist/booklist_tpl.html', '<div class="booklist-page"><div ng-include="\'booklist/booklist_head_part.html\'"></div><div class="books"><a class="book" ng-repeat="book in vm.booklist.books track by book.isbn" ui-sref="book({isbn: book.isbn})"><div class="book-image"><img class="cover cover-sm" ng-src="{{book.image}}"> <img class="cover-bg" ng-src="{{book.image}}"></div><div class="book-info"><div class="book-info-top"><span class="title">{{book.title}}</span><div class="rate"><span>&nbsp;{{book.rate}}</span><uib-rating class="red-star wechat-fix" ng-model="book.star" max="5" read-only="true" state-on="\'fa fa-star\'" state-off="\'fa fa-star-o\'"></uib-rating></div></div><span class="author" ng-if=\'book.author!=""\'><span ng-repeat="x in book.author track by $index">{{x}}</span></span></div><div class="reason"><p ng-bind-html="book.reason"></p></div></a></div><div class="booklist-bottom"><button class="btn" ng-click="vm.collect()" promise-btn><i ng-if="!vm.booklist.collect_already" class="fa fa-bookmark-o"></i> <i ng-if="vm.booklist.collect_already" class="fa fa-bookmark"></i> {{vm.booklist.collect}}</button> <button class="btn" ng-click="vm.collect()" promise-btn><i ng-if="!vm.booklist.collect_already" class="fa fa-heart-o"></i> <i ng-if="vm.booklist.collect_already" class="fa fa-heart"></i> {{vm.booklist.collect}}</button> <button class="btn" ui-sref="booklistComments" promise-btn><i class="fa fa-comment-o"></i> {{vm.booklist.collect}}</button></div></div>');

  $templateCache.put('booklist_comments/booklist_comments_tpl.html', '<div class="comments-page"><div class="navbar navbar-default navbar-fixed-top"><a class="navbar-brand"><i class="fa fa-book" aria-hidden="true"></i> {{vm.title}}</a></div><div class="book-comment" ng-repeat="comment in vm.comments"><comment-row comment="comment" up="vm.up" down="vm.down"></comment-row></div></div>');

  $templateCache.put('booklists/booklists_slides_part.html', '<div class="booklists"><div class="btn-group order"><button class="btn btn-default" ng-click="vm.timeOrder()">时间优先</button> <button class="btn btn-default" ng-click="vm.collectOrder()">收藏优先</button></div><booklist-row booklists="vm.booklists.list" scroll="vm.booklists"></booklist-row></div>');

  $templateCache.put('booklists/booklists_tpl.html', '<div class="booklists-page"><div class="tags"><div class="tags-header"><p>选书单</p><a ui-sref="tags">查看全部标签 ></a></div><div class="tags-list"><a class="btn btn-default tag" ng-repeat="tag in vm.tags track by $index" ui-sref="tagBooklists({tag: tag})">{{tag}}</a></div></div><div ng-include="\'booklists/booklists_slides_part.html\'"></div></div>');

  $templateCache.put('cart/cart_core_part.html', '<ul class="cart-list"><li class="book" ng-repeat="item in vm.items" ng-if="!item.deleted"><div class="shop-cart-item"><div class="checkbox"><label><span ng-class="{true: \'active\', false: \'\'}[item.checked]"><input type="checkbox" ng-model="item.checked" ng-click="vm.recount()"></span></label></div><a class="book-image" ui-sref="book({isbn: item.book.isbn})"><img ng-src="{{item.book.image}}"></a><div class="book-title"><a ui-sref="book({isbn: item.book.isbn})">{{item.book.title}}</a></div><p class="book-price">¥ {{item.price | number:2 }}</p><span class="book-count" ng-if="!vm.editStatu">X {{ item.number }}</span><div class="book-edit" ng-if="vm.editStatu"><i class="fa fa-trash-o fa-1x" ng-click="vm.removeBook(item)"></i><div class="book-edit-count"><i class="fa fa-minus" ng-click="vm.minus(item)"></i> <input type="number" ng-model="item.number" ng-change="vm.editBook(item)"> <i class="fa fa-plus" ng-click="vm.plus(item)"></i></div></div></div></li></ul>');

  $templateCache.put('cart/cart_tpl.html', '<div class="cart-page"><div class="cart-head"><span>购物车</span> <span ng-click="vm.edit()" ng-if="!vm.editStatu">编辑</span> <span ng-click="vm.editOk()" ng-if="vm.editStatu">完成</span></div><div ng-include="\'cart/cart_core_part.html\'"></div><div class="cart-to-order"><button class="btn btn-danger" ng-if="!vm.editStatu" ng-disabled="vm.count===0 || vm.editStatu" ng-click="vm.cart2order()">结算({{vm.count}})</button> <button class="btn btn-info" ng-if="vm.editStatu" ng-disabled="vm.count===0" promise-btn ng-click="vm.collect()">移入收藏夹({{vm.number}})</button> <button class="btn btn-success" ng-if="vm.editStatu" ng-disabled="vm.count===0" promise-btn ng-click="vm.removeBooks()">删除({{vm.number}})</button><div class="checkbox"><label><span ng-class="{true: \'active\', false: \'\'}[vm.checked]"><input type="checkbox" ng-model="vm.checked" ng-click="vm.selectAll()"></span></label> <label>全选</label></div><div class="cart-count" ng-if="!vm.editStatu"><label>¥ {{vm.price | number: 2}}</label></div></div></div>');

  $templateCache.put('cart2order/cart2order_tpl.html', '<div class="cart2order-page"><div class="cart2order"><div class="order-list"><div class="order"><div class="order-title"><span class="order-head">Bookist</span> <span class="order-status">待支付</span></div><div class="order-cart"><div class="colorBar"></div><div class="order-address rarrow" ui-sref="address()"><p class="name" ng-if="vm.x">收货人:{{vm.x.name}}<em>{{vm.x.phone}}</em></p><p class="address" ng-if="vm.x">收货地址:{{vm.x.dormitory}}</p><p class="empty" ng-if="!vm.x">你还没有添加地址信息</p></div><div class="colorBar"></div><div class="order-books"><div class="cart2order-book order-book" ng-repeat="item in vm.books"><img ng-src="{{item.book.image}}"></div><div class="cart2order-sum"><p>共{{vm.order.number}}件</p><p>小计: <span>¥ {{vm.order.price | number:2}}</span></p></div></div><div class="order-tip"><div class="order-tip-1"><span>送货方式</span> <span>送书上门</span></div><div class="order-tip-1"><span>付款方式</span> <span>货到付款</span></div></div></div></div><div class="cart-message"><p>庄瑞铭到次一游！</p></div></div></div><div class="make-order"><button class="btn btn-danger" ng-disabled="vm.no_address" promise-btn ng-click="vm.make()">提交订单</button><div class="cart-count"><label>总额: ¥ {{vm.order.price | number: 2}}</label></div></div></div>');

  $templateCache.put('collect_booklists/collect_booklists_tpl.html', '<div class="collect-booklists-page"><div ng-include="\'collect_booklists/collect_switch_part.html\'"></div><booklist-row booklists="vm.booklists"></booklist-row></div>');

  $templateCache.put('collect_booklists/collect_switch_part.html', '<div class="switch btn-group"><a class="btn btn-default" ui-sref="booklistsCollect">书单收藏夹</a> <a class="btn btn-default" ui-sref="booksCollect">书籍收藏夹</a></div>');

  $templateCache.put('collect_books/collect_books_tpl.html', '<div class="collect-books-page"><div ng-include="\'collect_booklists/collect_switch_part.html\'"></div><div class="books"><div class="empty-alert" ng-if="vm.books.length==0"><p>您还没有收藏书籍</p></div><book-row books="vm.books"></book-row></div></div>');

  $templateCache.put('comments/comments_tpl.html', '<div class="comments-page"><top-bar title="vm.title"></top-bar><div class="book-comment" ng-repeat="comment in vm.comments track by $index"><comment-row comment="comment" up="vm.up" down="vm.down"></comment-row></div></div>');

  $templateCache.put('index/index_slides_part.html', '<div class="slides"><uib-carousel active="0" interval="vm.myInterval" no-wrap="false" no-pause="true"><uib-slide ng-repeat="slide in vm.slides track by $index" index="slide.id"><img ng-src="{{slide.image}}"></uib-slide></uib-carousel></div>');

  $templateCache.put('index/index_tpl.html', '<div class="index-page"><div ng-include="\'index/index_slides_part.html\'"></div><div class="books"><div class="books-header"><i class="fa fa-book"></i> <span>书籍推荐</span> <a ui-sref="recommend">更多 ></a></div><book-slide ng-init="vm.books=[]" books="vm.books"></book-slide></div><div class="booklists" style="min-height: 400px;"><div class="booklists-header"><i class="fa fa-list"></i> <span>热门书单</span> <a ui-sref="popular">更多 ></a></div><booklist-row booklists="vm.booklists"></booklist-row></div></div>');

  $templateCache.put('me/me_tpl.html', '<div class="me"><div class="user"><img ui-sref="settings" ng-src="{{vm.user.avatar}}"><div ui-sref="settings" class="user-name"><p>{{vm.user.username}}</p></div><a ui-sref="settings"><i class="fa fa-cog fa-lg"></i></a> <a ui-sref="notices"><i class="fa fa-envelope-o fa-lg"></i></a></div><div class="order-panel"><div class="order-head user-item" ui-sref="orders({status:\'all\'})"><i class="fa fa-ticket"></i>全部订单</div><a ui-sref="orders({status:\'pending\'})" class="order-bar-split"><img src="/static/images/pending.png"> <span>待发货</span></a> <a ui-sref="orders({status:\'waiting\'})" class="order-bar-split"><img src="/static/images/waiting.png"> <span>待收货</span></a> <a ui-sref="orders({status:\'commenting\'})" class="order-bar-split"><img src="/static/images/commenting.png"> <span>待评价</span></a> <a ui-sref="orders({status:\'return\'})" class="order-bar-split"><img src="/static/images/return.png"> <span>退款/售后</span></a></div><div class="user-items"><a ui-sref="booklistsCollect" class="user-item"><i class="fa fa-folder"></i>收藏</a> <a ui-sref="comments" class="user-item"><i class="fa fa-comments"></i>评论</a> <a ui-sref="point" class="user-item"><i class="fa fa-ticket"></i>积分</a></div><div class="user-items"><a ui-sref="suggest" class="user-item"><i class="fa fa-commenting"></i>反馈</a></div></div>');

  $templateCache.put('navbar/navbar_tpl.html', '<nav class="bookist-nav navbar navbar-default" role="navigation"><ul class="nav navbar-nav"><li><a ui-sref="index"><i class="fa fa-home fa-lg"></i><p>首页</p></a></li><li><a ui-sref="booklists"><i class="fa fa-th-large fa-lg"></i><p>书单</p></a></li><li><a ui-sref="cart"><i class="fa fa-shopping-cart fa-lg"></i><p>购物车</p></a></li><li><a ui-sref="me"><i class="fa fa-user fa-lg"></i><p>我的</p></a></li></ul></nav>');

  $templateCache.put('notices/notices_tpl.html', '<ul class="notices"><div class="empty-alert" ng-if="vm.notices.length==0"><p>暂无消息</p></div><li class="notice" ng-repeat="notice in vm.notices"><div class="notice-title"><p ng-bind-html="notice.content"></p><span>{{notice.time*1000 | date:\'yyyy-MM-dd HH:mm\' }}</span></div><p class="notice-content">{{notice.content}}</p><a class="notice-read" ng-href="url"><span>查看</span> <i class="fa fa-chevron-right"></i></a></li></ul>');

  $templateCache.put('order_comments/order_comments_tpl.html', '<div class="order-comments-page"><div class="order-group"><form name="vm.commentForm" class="order-list-one"><div class="order-title"><span class="order-head">订单详细信息</span> <span class="order-status">建议您把书看完再来评价书籍哦~</span></div><ul class="order-books order-comments"><li class="order-book" ng-repeat="z in vm.order.carts"><a ui-sref="book({isbn: z.book.isbn})" class="order-img"><img ng-src="{{z.book.image}}"></a><div class="order-comment"><textarea class="form-control" ng-model="z.book.content" rows="3" placeholder="认真评价可以获得积分哦~" required></textarea></div><div class="order-star"><comment-star title="书籍评分" stars="z.book.star"></comment-star></div></li></ul><div class="platform-comment"><div class="platform-comment-title"><span class="order-head">平台评分</span></div><ul class="platform-comment-items"><li><comment-star title="购书体验" stars="vm.stars1"></comment-star></li><li><comment-star title="物流服务" stars="vm.stars2"></comment-star></li><li><comment-star title="服务态度" stars="vm.stars3"></comment-star></li></ul></div><div class="order-comment-fix-bottom"><button class="btn btn-danger" ng-click="vm.comment()" promise-btn>发表评价</button></div></form></div></div>');

  $templateCache.put('order_detail/order_detail_tpl.html', '<div class="order-detail-page"><div class="order-group"><ul class="order-list"><li class="order-list-one"><div class="order-title"><span class="order-head">订单详细信息</span> <span class="order-status">共{{vm.price}}元</span></div><ul class="order-books"><a class="order-book" ng-repeat="z in vm.order.carts" ui-sref="book({isbn: z.book.isbn})"><img ng-src="{{z.book.image}}"><p>{{z.book.title}}</p><small ng-repeat="x in z.book.author"><small>{{x}}</small></small> <span class="count">{{z.number}}本 / 共{{z.price*z.number | number:2}}元</span></a></ul><div class="order-detail"><div class="order-title"><span class="order-head">订单状态</span> <span class="order-status">{{vm.order.status}}</span></div><ul class="order-process"><li ng-repeat="x in vm.status_list"><span>{{x.status}}</span> <span>{{x.time*1000 | date:\'yyyy-MM-dd HH:mm\'}}</span></li></ul></div><div class="order-receipt"><div class="order-title"><span class="order-head">订单收货信息</span></div><div class="order-receipt-meta"><p>收货人: {{vm.order.address.name}}</p><p>联系电话: {{vm.order.address.phone}}</p><p>收货地址: {{vm.order.address.dormitory}}</p></div></div><div class="order-detail-clear"></div><div class="order-meta order-meta-fix-bottom"><div class="order-meta-price"><span class="order-price">货到付款&nbsp;&nbsp;&nbsp;<em>{{vm.price}}</em> 元</span></div><a class="btn btn-danger" ng-if="vm.order.status==\'待评价\'" style="width: 95px;" ui-sref="orderComments({id: order.id})">评价</a> <button class="btn btn-danger" ng-if="vm.order.status==\'待收货\'" ng-click="vm.receipt(vm.order)">确认收货</button> <button class="btn btn-danger" promise-btn ng-if="vm.order.status==\'待发货\'" ng-click="vm.cancel(vm.order)">取消订单</button> <button class="btn btn-danger" ng-if="vm.order.status==\'已取消\'" style="width: 95px;" disabled>已取消</button></div></li></ul></div></div>');

  $templateCache.put('orders/orders_tpl.html', '<div class="order-page"><div class="order-group"><ul class="order-list" ng-if="vm.orders_return.length>0"><li class="order-list-one" ng-repeat="order in vm.orders_return"><div class="order-title"><span class="order-head">Bookist</span> <span class="order-status">{{vm.order.status}}</span></div><a ui-sref="orderDetail({id:order.id})"><ul class="order-books" style="margin-bottom: 0"><li class="order-book" ng-repeat="z in vm.orders_return.carts"><img ng-src="{{z.book.image}}"><p>{{z.book.title}}</p><small ng-repeat="x in z.book.author"><small>{{x}}</small></small> <span class="count">{{z.number}}本 / 共{{z.price*z.number | number:2}}元</span></li></ul></a><div class="order-meta"><div class="order-meta-price"><span class="order-method">货到付款</span> <span class="order-price">实付款 {{vm.order.price}} 元</span></div><a class="btn btn-danger" ng-bind="order.status" ui-sref="orderDetail({id:order.id})"></a> <button class="btn btn-danger" promise-btn ng-if="vm.order.status!=\'refund\'&&vm.order.status!=\'replace\'" ng-click="vm.cancelReturn(order)">取消订单</button></div></li></ul><ul class="order-list"><li class="order-list-one" ng-repeat="order in vm.orders"><div class="order-title"><span class="order-head">Bookist</span> <span class="order-status">{{order.status}}</span></div><a ui-sref="orderDetail({id:order.id})"><ul class="order-books" style="margin-bottom: 0"><li class="order-book" ng-repeat="z in order.carts"><img ng-src="{{z.book.image}}"><p>{{z.book.title}}</p><small ng-repeat="x in z.book.author"><small>{{x}}</small></small> <span class="count">{{z.number}}本 / 共{{z.price*z.number | number:2}}元</span></li></ul></a><div class="order-meta"><div class="order-meta-price"><span class="order-price">货到付款&nbsp;&nbsp;&nbsp;<em>{{order.price}}</em> 元</span></div><a class="btn btn-danger" ng-if="type==\'return\'" style="width: 82px;" ui-sref="orderReturn({id: order.id})">退换货</a> <a class="btn btn-danger" ng-if="order.status==\'待评价\'" ui-sref="orderComments({id: order.id})">评价</a> <button class="btn btn-danger" promise-btn ng-if="order.status==\'待收货\'" ng-click="vm.receipt(order)">确认收货</button> <button class="btn btn-danger" promise-btn ng-if="order.status==\'待发货\'" ng-click="vm.cancel(order)">取消订单</button> <button class="btn btn-danger" ng-if="order.status==\'已取消\'" disabled>已取消</button></div></li></ul></div></div>');

  $templateCache.put('point/point_tpl.html', '<div class="points"><div class="point-history"><div class="point-header"><span>当前积分: {{vm.points.now_points}}</span></div><ul class="point-list"><li ng-repeat="x in vm.points.logs"><span class="point-title" ng-bind-html="x.content"></span> <span class="point-result" ng-if="x.point>0">+ {{x.point}}</span> <span class="point-result" ng-if="x.point<0">- {{-x.point}}</span></li></ul></div></div>');

  $templateCache.put('popular_more/popular_more_tpl.html', '<div class="popular-more-page"><booklist-row booklists="vm.booklists.list" scroll="vm.booklists"></booklist-row></div>');

  $templateCache.put('recommend_more/recommend_more_tpl.html', '<div class="recommend-more-page" style="background-color: white; overflow: hidden;"><book-row books="vm.books.list" scroll="vm.book"></book-row></div>');

  $templateCache.put('setting_address/setting_address_tpl.html', '<div class="setting-address-page"><div class="address-list" ng-repeat="x in vm.address" ng-click="vm.edit(x)"><p>{{x.name}}, {{x.phone}}</p><small>{{x.dormitory}}</small> <span ng-if="x.is_default">默认地址</span></div><div class="btn-group"><button class="btn btn-success" ui-sref="AddressAdd">添加</button> <button class="btn btn-default" ng-click="vm.back()">返回</button></div></div>');

  $templateCache.put('setting_address_add/setting_address_add_tpl.html', '<div class="setting"><form name="vm.addressForm"><div class="form-group"><label>收货人</label> <input type="text" name="name" maxlength="10" ng-required="true" ng-model="vm.name" class="form-control" placeholder="姓名"></div><div class="form-group"><label>手机号码</label> <input type="tel" name="phone" ng-model="vm.phone" class="form-control" placeholder="11位手机号" my-maxlength="11" ng-required="true" ng-minlength="11" ng-maxlength="11" minlength="11" maxlength="11"></div><div class="form-group"><label>宿舍地址</label> <input type="text" name="dorm" ng-model="vm.dormitory" maxlength="30" class="form-control" ng-required="true" placeholder="宿舍位置"></div><div class="btn-group"><button class="btn btn-success" promise-btn ng-if="!vm.edit" ng-click="vm.addAddress()">添加</button> <button class="btn btn-success" promise-btn ng-if="vm.edit" ng-click="vm.updateAddress()">修改</button> <button class="btn btn-danger" promise-btn ng-if="vm.edit" ng-click="vm.deleteAddress(vm.id)">删除</button> <button class="btn btn-info" promise-btn ng-if="vm.edit" ng-click="vm.setDefaultAddress(vm.id)">设置为默认地址</button> <button class="btn btn-default" ng-click="vm.back()">返回</button></div></form></div>');

  $templateCache.put('settings/settings_tpl.html', '<div class="settings-page"><div class="user-items"><a class="user-item"><i class="fa fa-folder user-item-gravatar"><span>头像</span></i> <img ng-src="{{vm.user.avatar}}"></a> <a class="user-item"><i class="fa fa-comments"><span>昵称</span></i> <span>{{vm.user.username}}</span></a></div><div class="user-items"><a class="user-item"><i class="fa fa-cloud"><span>性别</span></i> <i class="fa fa-mars" aria-hidden="true" ng-if="vm.user.sex === 1"></i> <i class="fa fa-venus" aria-hidden="true" ng-if="vm.user.sex === 2"></i></a> <a ui-sref="address" class="user-item"><i class="fa fa-commenting"><span>我的地址</span></i></a></div></div>');

  $templateCache.put('suggest/suggest_tpl.html', '<div class="suggest"><div class="i-suggest"><div class="suggest-header"><h4>说出你的建议和看法帮助改善平台</h4></div><hr><div class="input-group"><img ng-src="{{vm.user.avatar}}"></div><form class="suggestion" name="vm.suggestBox"><textarea class="form-control" name="suggestion" required autofocus ng-model="vm.suggestion"></textarea> <input type="submit" class="btn btn-block btn-info" promise-btn ng-click="vm.post()"></form></div></div>');

  $templateCache.put('tag-booklists/tag-booklists_tpl.html', '<div class="tags-booklists-page"><div ng-include="\'booklists/booklists_slides_part.html\'"></div></div>');

  $templateCache.put('tags/tags_tpl.html', '<div class="tags-page"><span>全部标签</span><div class="tags-group" ng-repeat="oneTags in vm.allTags"><div class="tags-group-one"><p>{{oneTags.title}}</p><a class="btn btn-default" ng-repeat="tag in oneTags.tags" ui-sref="tagBooklists({tag: tag})">{{tag}}</a></div></div></div>');

  $templateCache.put('user_comments/user_comments_tpl.html', '<div class="user-comments-page"><ul class="comments"><li ng-repeat="comment in vm.comments track by $index"><div class="comment-title"><div class="comment-action"><i class="fa fa-trash-o" ng-click="comment.deleteBox=true"></i> <i class="fa fa-pencil-square-o" ng-click="vm.focus(comment)"></i></div><p>{{comment.book.title}}</p></div><form name="commentForm" class="comment-book"><a ui-sref="book({isbn:comment.book.isbn})"><img ng-src="{{comment.book.image}}"></a><div class="comment-content"><textarea class="form-control" rows="3" name="content" ng-required="true" ng-model="comment.content" ng-bind-html="comment.content" ng-readonly="comment.readonly" focus-me="{{comment.edit}}"></textarea></div><div class="comment-star"><i class="fa fa-thumbs-o-up comment-up">{{comment.up}}</i> <i class="fa fa-thumbs-o-down comment-down">{{comment.down}}</i> <button ng-if="comment.edit" class="btn btn-success" promise-btn ng-click="vm.submit(comment)">确认修改</button><uib-rating ng-model="comment.star" max="5" read-only="!comment.edit" class="red-star star" ng-class="{true: \'comment-star-left\'}[comment.edit]" state-on="\'fa fa-star\'" state-off="\'fa fa-star-o\'"></uib-rating></div></form><delete-box content="comment" commit="vm.delete(comment)" cancel="comment.deleteBox" ng-if="comment.deleteBox"></delete-box></li></ul></div>');

}]);

})();